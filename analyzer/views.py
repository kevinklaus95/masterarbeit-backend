from rest_framework import viewsets
from rest_framework.decorators import api_view
from .serializers import HoursSerializer
from .models import Hours
from rest_framework.response import Response
from .analyze import analyze
from datetime import datetime, timedelta
from pprint import pprint

mock_dict = [{'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 1,
              'start': datetime(2016, 1, 1, 0, 0),
              'stop': datetime(2016, 1, 15, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 2,
              'start': datetime(2016, 1, 15, 0, 0),
              'stop': datetime(2016, 1, 29, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 3,
              'start': datetime(2016, 1, 29, 0, 0),
              'stop': datetime(2016, 2, 12, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 4,
              'start': datetime(2016, 2, 12, 0, 0),
              'stop': datetime(2016, 2, 26, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 5,
              'start': datetime(2016, 2, 26, 0, 0),
              'stop': datetime(2016, 3, 11, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 6,
              'start': datetime(2016, 3, 11, 0, 0),
              'stop': datetime(2016, 3, 25, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 7,
              'start': datetime(2016, 3, 25, 0, 0),
              'stop': datetime(2016, 4, 8, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 8,
              'start': datetime(2016, 4, 8, 0, 0),
              'stop': datetime(2016, 4, 22, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 9,
              'start': datetime(2016, 4, 22, 0, 0),
              'stop': datetime(2016, 5, 6, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 10,
              'start': datetime(2016, 5, 6, 0, 0),
              'stop': datetime(2016, 5, 20, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 11,
              'start': datetime(2016, 5, 20, 0, 0),
              'stop': datetime(2016, 6, 3, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 12,
              'start': datetime(2016, 6, 3, 0, 0),
              'stop': datetime(2016, 6, 17, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 13,
              'start': datetime(2016, 6, 17, 0, 0),
              'stop': datetime(2016, 7, 1, 0, 0)},
             {'comment': 'Mandy, Urlaub ',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 14,
              'start': datetime(2016, 7, 1, 0, 0),
              'stop': datetime(2016, 7, 15, 0, 0)},
             {'comment': '',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 15,
              'start': datetime(2016, 7, 15, 0, 0),
              'stop': datetime(2016, 7, 29, 0, 0)},
             {'comment': 'Dokumentation, Email an Frau Kirmes zu Antrag '
                         'Mittagsverpflegung, Sicherung Lebensunterhalt  SMS-Kontakt bzgl. '
                         'Unterlagen Bildungspaket, Terminrücksprache, Stimmungsbild,  '
                         'Fallspezifische Beratung zum Hilfeverlauf,  Büro: '
                         'Wochenreflexion, Postbearbeitung, Beratung zum suchtspezifischen '
                         'Angebot, Telefonat Frau Flohrer (Therapieeinrichtung), '
                         'Vorbereitung Fragebogen,Suchtanamnese,  Email an SBB wegen '
                         'Therapie und Möglichkeiten der suchtspezifischen Begleitung  '
                         'Telefonat mit Frau Placzek (UV) wegen Antrag UV, Telefonat mit '
                         'KM wegen Termin Jugendamt, aktueller Stand Therapievorbereitung  '
                         'Telefonat mit Frau Riebschläger zu Perspektiven LZT, Beratung '
                         'Rückführungsoptionen  Dokumentation,  Telefonat/e KM und Kita, '
                         'Rücksprache Abholung Kind, aktueller Hilfestand und '
                         'Perspektivenberatung, Rücksprache bzgl. Kinderbetreuung '
                         'Hilfeplangespräch, anschließendes Reflexionsgespräch mit Frau '
                         'Saba Fallabsprache mit SBB bzgl. Hilfeplangespräch '
                         'Fallspezifische Beratung zum Hilfeverlauf,  Telefonat mit '
                         'C.Grosche wegen aktuellem Stand Therapie KV mit Kind, '
                         'Reflexionsgespräch Hilfeplan Telefonat mit Frau Saba wegen '
                         'Reflexion Hilfeplan, Rücksprache zu Perspektiven LZT Telefonat/e '
                         'mit Schwester, Rücksprache zu Aufgaben Wechselantrag Kita, '
                         'Absprachen Kitaadressen Büro: Vorbereitung von Anträgen für '
                         'Jobcenter bzgl. KG, Drogenscreening, Aktenpflege, Vorbereitung '
                         'Wechselantrag, Reflexion Hilfeplangespräch, '
                         'Sensibilisierung/Beratung für/zu Entwicklungsbedürfnissen und '
                         'altergerechte Förderung der Kinder, Beratung zur '
                         'Drogenlangzeittherapie Telefonat mit Frau Saba zu Therapie KV '
                         'mit Kind, Terminreflexion (Jobcenter, Ärzte, Psychologe, etc.),  '
                         'Telefonat mit Schwester bzgl. Wechselantrag und Ummeldung '
                         'Emelly; Beibringen von Unterlagen ',
              'counters': {'Kalt': -21, 'Warm': 3},
              'id': 16,
              'start': datetime(2016, 7, 29, 0, 0),
              'stop': datetime(2016, 8, 12, 0, 0)},
             {'comment': 'Dokumentation,  Telefonat mit Frau Placzek bzgl. Absprachen zum '
                         'Antrag UV Telefonat/e, Telefonat mit KM: Rücksprache zur '
                         'Ummeldung und Antrag Kitawechsel; Rücksprache bzgl. '
                         'Terminreflexion SBB und Umwidmung LZT\r\n'
                         ' ',
              'counters': {'Kalt': 0, 'Warm': 0},
              'id': 17,
              'start': datetime(2016, 8, 12, 0, 0),
              'stop': datetime(2016, 8, 15, 0, 0)}]

mock_lda = {'entries': {1: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                            'position': 0,
                            'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                            'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                    'Topic1': 0.3333333333333333,
                                                    'Topic2': 0.3333333333333333},
                            'word_occurrence': [0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0]},
                        2: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                            'position': 1,
                            'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                            'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                    'Topic1': 0.3333333333333333,
                                                    'Topic2': 0.3333333333333333},
                            'word_occurrence': [0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0]},
                        3: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                            'position': 2,
                            'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                            'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                    'Topic1': 0.3333333333333333,
                                                    'Topic2': 0.3333333333333333},
                            'word_occurrence': [0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0]},
                        4: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                            'position': 3,
                            'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                            'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                    'Topic1': 0.3333333333333333,
                                                    'Topic2': 0.3333333333333333},
                            'word_occurrence': [0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0]},
                        5: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                            'position': 4,
                            'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                            'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                    'Topic1': 0.3333333333333333,
                                                    'Topic2': 0.3333333333333333},
                            'word_occurrence': [0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0]},
                        6: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                            'position': 5,
                            'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                            'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                    'Topic1': 0.3333333333333333,
                                                    'Topic2': 0.3333333333333333},
                            'word_occurrence': [0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0]},
                        7: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                            'position': 6,
                            'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                            'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                    'Topic1': 0.3333333333333333,
                                                    'Topic2': 0.3333333333333333},
                            'word_occurrence': [0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0]},
                        8: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                            'position': 7,
                            'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                            'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                    'Topic1': 0.3333333333333333,
                                                    'Topic2': 0.3333333333333333},
                            'word_occurrence': [0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0]},
                        9: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                            'position': 8,
                            'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                            'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                    'Topic1': 0.3333333333333333,
                                                    'Topic2': 0.3333333333333333},
                            'word_occurrence': [0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0,
                                                0]},
                        10: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                             'position': 9,
                             'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                             'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                     'Topic1': 0.3333333333333333,
                                                     'Topic2': 0.3333333333333333},
                             'word_occurrence': [0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0]},
                        11: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                             'position': 10,
                             'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                             'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                     'Topic1': 0.3333333333333333,
                                                     'Topic2': 0.3333333333333333},
                             'word_occurrence': [0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0]},
                        12: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                             'position': 11,
                             'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                             'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                     'Topic1': 0.3333333333333333,
                                                     'Topic2': 0.3333333333333333},
                             'word_occurrence': [0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0]},
                        13: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                             'position': 12,
                             'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                             'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                     'Topic1': 0.3333333333333333,
                                                     'Topic2': 0.3333333333333333},
                             'word_occurrence': [0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0]},
                        14: {'is_normalized': {'normalized': True,
                                               'probability_sum': 0.9999999999999999},
                             'position': 13,
                             'top_topics': ['Topic0', 'Topic2', 'Topic1'],
                             'topic_probabilities': {'Topic0': 0.9130434782608695,
                                                     'Topic1': 0.043478260869565216,
                                                     'Topic2': 0.043478260869565216},
                             'word_occurrence': [1,
                                                 1,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0]},
                        15: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                             'position': 14,
                             'top_topics': ['Topic2', 'Topic1', 'Topic0'],
                             'topic_probabilities': {'Topic0': 0.3333333333333333,
                                                     'Topic1': 0.3333333333333333,
                                                     'Topic2': 0.3333333333333333},
                             'word_occurrence': [0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0]},
                        16: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                             'position': 15,
                             'top_topics': ['Topic1', 'Topic2', 'Topic0'],
                             'topic_probabilities': {'Topic0': 0.17608337904552937,
                                                     'Topic1': 0.4832693362589139,
                                                     'Topic2': 0.34064728469555683},
                             'word_occurrence': [0,
                                                 0,
                                                 2,
                                                 2,
                                                 2,
                                                 7,
                                                 1,
                                                 5,
                                                 2,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 5,
                                                 2,
                                                 1,
                                                 1,
                                                 1,
                                                 2,
                                                 5,
                                                 3,
                                                 2,
                                                 2,
                                                 1,
                                                 1,
                                                 2,
                                                 1,
                                                 8,
                                                 1,
                                                 1,
                                                 3,
                                                 1,
                                                 2,
                                                 5,
                                                 3,
                                                 5,
                                                 1,
                                                 2,
                                                 1,
                                                 12,
                                                 1,
                                                 2,
                                                 2,
                                                 1,
                                                 1,
                                                 2,
                                                 2,
                                                 1,
                                                 1,
                                                 2,
                                                 2,
                                                 1,
                                                 2,
                                                 2,
                                                 4,
                                                 1,
                                                 3,
                                                 1,
                                                 1,
                                                 1,
                                                 3,
                                                 1,
                                                 2,
                                                 3,
                                                 1,
                                                 1,
                                                 1,
                                                 2,
                                                 2,
                                                 2,
                                                 2,
                                                 1,
                                                 3,
                                                 1,
                                                 1,
                                                 2,
                                                 1,
                                                 1,
                                                 2,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 1,
                                                 0,
                                                 0]},
                        17: {'is_normalized': {'normalized': True, 'probability_sum': 1.0},
                             'position': 16,
                             'top_topics': ['Topic1', 'Topic2', 'Topic0'],
                             'topic_probabilities': {'Topic0': 0.0036630036630036634,
                                                     'Topic1': 0.5164835164835165,
                                                     'Topic2': 0.47985347985347987},
                             'word_occurrence': [0,
                                                 0,
                                                 1,
                                                 0,
                                                 0,
                                                 1,
                                                 0,
                                                 0,
                                                 2,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 2,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 1,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 2,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 1,
                                                 0,
                                                 0,
                                                 2,
                                                 0,
                                                 0,
                                                 0,
                                                 2,
                                                 1,
                                                 1,
                                                 1,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 1,
                                                 0,
                                                 1,
                                                 0,
                                                 2,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 1,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 0,
                                                 1,
                                                 0,
                                                 1,
                                                 0,
                                                 0,
                                                 0,
                                                 1,
                                                 0,
                                                 0,
                                                 1,
                                                 1]}},
            'filtered': {},
            'is_normalized': {'entry_topic_probabilities': True,
                              'topic_word_probabilities': True},
            'topics': {'Topic0': {'is_normalized': {'normalized': True,
                                                    'probability_sum': 0.9999999999999994},
                                  'top_words': ['zu',
                                                'Wechselantrag',
                                                'Kita',
                                                'an',
                                                'Reflexionsgespräch',
                                                'Hilfeplan',
                                                'Mandy',
                                                'Aufgaben'],
                                  'word_probabilities': {'Abholung': 0.000285795941697628,
                                                         'Absprachen': 0.000285795941697628,
                                                         'Aktenpflege': 0.000285795941697628,
                                                         'Angebot': 0.000285795941697628,
                                                         'Antrag': 0.000285795941697628,
                                                         'Anträgen': 0.000285795941697628,
                                                         'Aufgaben': 0.02886539011146043,
                                                         'Begleitung': 0.000285795941697628,
                                                         'Beibringen': 0.02886539011146043,
                                                         'Beratung': 0.000285795941697628,
                                                         'Bildungspaket': 0.02886539011146043,
                                                         'Büro': 0.000285795941697628,
                                                         'CGrosche': 0.000285795941697628,
                                                         'Dokumentation': 0.000285795941697628,
                                                         'Drogenlangzeittherapie': 0.000285795941697628,
                                                         'Drogenscreening': 0.02886539011146043,
                                                         'Email': 0.000285795941697628,
                                                         'Emelly': 0.000285795941697628,
                                                         'Entwicklungsbedürfnissen': 0.000285795941697628,
                                                         'Fallabsprache': 0.000285795941697628,
                                                         'Fallspezifische': 0.000285795941697628,
                                                         'Flohrer': 0.000285795941697628,
                                                         'FragebogenSuchtanamnese': 0.000285795941697628,
                                                         'Frau': 0.000285795941697628,
                                                         'Förderung': 0.000285795941697628,
                                                         'Hilfeplan': 0.05744498428122322,
                                                         'Hilfeplangespräch': 0.000285795941697628,
                                                         'Hilfestand': 0.02886539011146043,
                                                         'Hilfeverlauf': 0.000285795941697628,
                                                         'Jobcenter': 0.000285795941697628,
                                                         'Jugendamt': 0.000285795941697628,
                                                         'KG': 0.000285795941697628,
                                                         'KM': 0.000285795941697628,
                                                         'KV': 0.000285795941697628,
                                                         'Kind': 0.000285795941697628,
                                                         'Kinder': 0.02886539011146043,
                                                         'Kinderbetreuung': 0.000285795941697628,
                                                         'Kirmes': 0.000285795941697628,
                                                         'Kita': 0.05744498428122322,
                                                         'Kitaadressen': 0.02886539011146043,
                                                         'Kitawechsel': 0.000285795941697628,
                                                         'LZT': 0.000285795941697628,
                                                         'Lebensunterhalt': 0.02886539011146043,
                                                         'Mandy': 0.02886539011146043,
                                                         'Mittagsverpflegung': 0.000285795941697628,
                                                         'Möglichkeiten': 0.000285795941697628,
                                                         'Perspektiven': 0.000285795941697628,
                                                         'Perspektivenberatung': 0.000285795941697628,
                                                         'Placzek': 0.000285795941697628,
                                                         'Postbearbeitung': 0.000285795941697628,
                                                         'Psychologe': 0.000285795941697628,
                                                         'Reflexion': 0.000285795941697628,
                                                         'Reflexionsgespräch': 0.05744498428122322,
                                                         'Riebschläger': 0.000285795941697628,
                                                         'Rückführungsoptionen': 0.02886539011146043,
                                                         'Rücksprache': 0.000285795941697628,
                                                         'SBB': 0.000285795941697628,
                                                         'SMSKontakt': 0.000285795941697628,
                                                         'Saba': 0.000285795941697628,
                                                         'Schwester': 0.000285795941697628,
                                                         'SensibilisierungBeratung': 0.02886539011146043,
                                                         'Sicherung': 0.000285795941697628,
                                                         'Stand': 0.000285795941697628,
                                                         'Stimmungsbild': 0.02886539011146043,
                                                         'Telefonat': 0.000285795941697628,
                                                         'Telefonate': 0.000285795941697628,
                                                         'Termin': 0.000285795941697628,
                                                         'Terminreflexion': 0.000285795941697628,
                                                         'Terminrücksprache': 0.000285795941697628,
                                                         'Therapie': 0.000285795941697628,
                                                         'Therapieeinrichtung': 0.02886539011146043,
                                                         'Therapievorbereitung': 0.000285795941697628,
                                                         'UV': 0.000285795941697628,
                                                         'Ummeldung': 0.000285795941697628,
                                                         'Umwidmung': 0.000285795941697628,
                                                         'Unterlagen': 0.000285795941697628,
                                                         'Urlaub': 0.02886539011146043,
                                                         'Vorbereitung': 0.000285795941697628,
                                                         'Wechselantrag': 0.08602457845098602,
                                                         'Wochenreflexion': 0.02886539011146043,
                                                         'aktuellem': 0.000285795941697628,
                                                         'aktueller': 0.000285795941697628,
                                                         'altergerechte': 0.02886539011146043,
                                                         'an': 0.05744498428122322,
                                                         'anschließendes': 0.000285795941697628,
                                                         'bzgl': 0.000285795941697628,
                                                         'der': 0.000285795941697628,
                                                         'etc': 0.000285795941697628,
                                                         'für': 0.02886539011146043,
                                                         'fürzu': 0.000285795941697628,
                                                         'mit': 0.000285795941697628,
                                                         'suchtspezifischen': 0.000285795941697628,
                                                         'und': 0.000285795941697628,
                                                         'von': 0.000285795941697628,
                                                         'wegen': 0.000285795941697628,
                                                         'zu': 0.14318376679051162,
                                                         'zum': 0.000285795941697628,
                                                         'zur': 0.000285795941697628,
                                                         'Ärzte': 0.02886539011146043}},
                       'Topic1': {'is_normalized': {'normalized': True,
                                                    'probability_sum': 0.9999999999999994},
                                  'top_words': ['mit',
                                                'bzgl',
                                                'und',
                                                'Rücksprache',
                                                'Beratung',
                                                'wegen',
                                                'Therapie',
                                                'Telefonate'],
                                  'word_probabilities': {'Abholung': 0.009806777357024954,
                                                         'Absprachen': 9.709680551509856e-05,
                                                         'Aktenpflege': 9.709680551509856e-05,
                                                         'Angebot': 0.009806777357024954,
                                                         'Antrag': 9.709680551509856e-05,
                                                         'Anträgen': 9.709680551509856e-05,
                                                         'Aufgaben': 9.709680551509856e-05,
                                                         'Begleitung': 0.009806777357024954,
                                                         'Beibringen': 9.709680551509856e-05,
                                                         'Beratung': 0.048645499563064375,
                                                         'Bildungspaket': 9.709680551509856e-05,
                                                         'Büro': 9.709680551509856e-05,
                                                         'CGrosche': 0.009806777357024954,
                                                         'Dokumentation': 0.029226138460044664,
                                                         'Drogenlangzeittherapie': 0.009806777357024954,
                                                         'Drogenscreening': 9.709680551509856e-05,
                                                         'Email': 9.709680551509856e-05,
                                                         'Emelly': 0.009806777357024954,
                                                         'Entwicklungsbedürfnissen': 0.009806777357024954,
                                                         'Fallabsprache': 0.009806777357024954,
                                                         'Fallspezifische': 0.019516457908534807,
                                                         'Flohrer': 9.709680551509856e-05,
                                                         'FragebogenSuchtanamnese': 9.709680551509856e-05,
                                                         'Frau': 9.709680551509856e-05,
                                                         'Förderung': 9.709680551509856e-05,
                                                         'Hilfeplan': 9.709680551509856e-05,
                                                         'Hilfeplangespräch': 9.709680551509856e-05,
                                                         'Hilfestand': 9.709680551509856e-05,
                                                         'Hilfeverlauf': 0.019516457908534807,
                                                         'Jobcenter': 0.019516457908534807,
                                                         'Jugendamt': 0.009806777357024954,
                                                         'KG': 9.709680551509856e-05,
                                                         'KM': 9.709680551509856e-05,
                                                         'KV': 0.019516457908534807,
                                                         'Kind': 9.709680551509856e-05,
                                                         'Kinder': 9.709680551509856e-05,
                                                         'Kinderbetreuung': 0.009806777357024954,
                                                         'Kirmes': 9.709680551509856e-05,
                                                         'Kita': 9.709680551509856e-05,
                                                         'Kitaadressen': 9.709680551509856e-05,
                                                         'Kitawechsel': 9.709680551509856e-05,
                                                         'LZT': 0.029226138460044664,
                                                         'Lebensunterhalt': 9.709680551509856e-05,
                                                         'Mandy': 9.709680551509856e-05,
                                                         'Mittagsverpflegung': 0.009806777357024954,
                                                         'Möglichkeiten': 9.709680551509856e-05,
                                                         'Perspektiven': 0.019516457908534807,
                                                         'Perspektivenberatung': 9.709680551509856e-05,
                                                         'Placzek': 9.709680551509856e-05,
                                                         'Postbearbeitung': 9.709680551509856e-05,
                                                         'Psychologe': 0.009806777357024954,
                                                         'Reflexion': 9.709680551509856e-05,
                                                         'Reflexionsgespräch': 9.709680551509856e-05,
                                                         'Riebschläger': 9.709680551509856e-05,
                                                         'Rückführungsoptionen': 9.709680551509856e-05,
                                                         'Rücksprache': 0.05835518011457423,
                                                         'SBB': 9.709680551509856e-05,
                                                         'SMSKontakt': 9.709680551509856e-05,
                                                         'Saba': 0.029226138460044664,
                                                         'Schwester': 0.019516457908534807,
                                                         'SensibilisierungBeratung': 9.709680551509856e-05,
                                                         'Sicherung': 0.009806777357024954,
                                                         'Stand': 0.019516457908534807,
                                                         'Stimmungsbild': 9.709680551509856e-05,
                                                         'Telefonat': 9.709680551509856e-05,
                                                         'Telefonate': 0.029226138460044664,
                                                         'Termin': 9.709680551509856e-05,
                                                         'Terminreflexion': 9.709680551509856e-05,
                                                         'Terminrücksprache': 0.009806777357024954,
                                                         'Therapie': 0.029226138460044664,
                                                         'Therapieeinrichtung': 9.709680551509856e-05,
                                                         'Therapievorbereitung': 9.709680551509856e-05,
                                                         'UV': 9.709680551509856e-05,
                                                         'Ummeldung': 0.019516457908534807,
                                                         'Umwidmung': 0.009806777357024954,
                                                         'Unterlagen': 0.019516457908534807,
                                                         'Urlaub': 9.709680551509856e-05,
                                                         'Vorbereitung': 0.029226138460044664,
                                                         'Wechselantrag': 9.709680551509856e-05,
                                                         'Wochenreflexion': 9.709680551509856e-05,
                                                         'aktuellem': 9.709680551509856e-05,
                                                         'aktueller': 0.019516457908534807,
                                                         'altergerechte': 9.709680551509856e-05,
                                                         'an': 9.709680551509856e-05,
                                                         'anschließendes': 9.709680551509856e-05,
                                                         'bzgl': 0.06806486066608408,
                                                         'der': 0.019516457908534807,
                                                         'etc': 0.009806777357024954,
                                                         'für': 9.709680551509856e-05,
                                                         'fürzu': 9.709680551509856e-05,
                                                         'mit': 0.13603262452665307,
                                                         'suchtspezifischen': 9.709680551509856e-05,
                                                         'und': 0.06806486066608408,
                                                         'von': 9.709680551509856e-05,
                                                         'wegen': 0.048645499563064375,
                                                         'zu': 9.709680551509856e-05,
                                                         'zum': 9.709680551509856e-05,
                                                         'zur': 0.019516457908534807,
                                                         'Ärzte': 9.709680551509856e-05}},
                       'Topic2': {'is_normalized': {'normalized': True,
                                                    'probability_sum': 0.9999999999999994},
                                  'top_words': ['Telefonat',
                                                'Frau',
                                                'Antrag',
                                                'zum',
                                                'Kind',
                                                'KM',
                                                'UV',
                                                'Hilfeplangespräch'],
                                  'word_probabilities': {'Abholung': 0.0001315962626661403,
                                                         'Absprachen': 0.026450848795894197,
                                                         'Aktenpflege': 0.01329122252928017,
                                                         'Angebot': 0.0001315962626661403,
                                                         'Antrag': 0.05277010132912226,
                                                         'Anträgen': 0.01329122252928017,
                                                         'Aufgaben': 0.0001315962626661403,
                                                         'Begleitung': 0.0001315962626661403,
                                                         'Beibringen': 0.0001315962626661403,
                                                         'Beratung': 0.0001315962626661403,
                                                         'Bildungspaket': 0.0001315962626661403,
                                                         'Büro': 0.026450848795894197,
                                                         'CGrosche': 0.0001315962626661403,
                                                         'Dokumentation': 0.0001315962626661403,
                                                         'Drogenlangzeittherapie': 0.0001315962626661403,
                                                         'Drogenscreening': 0.0001315962626661403,
                                                         'Email': 0.026450848795894197,
                                                         'Emelly': 0.0001315962626661403,
                                                         'Entwicklungsbedürfnissen': 0.0001315962626661403,
                                                         'Fallabsprache': 0.0001315962626661403,
                                                         'Fallspezifische': 0.0001315962626661403,
                                                         'Flohrer': 0.01329122252928017,
                                                         'FragebogenSuchtanamnese': 0.01329122252928017,
                                                         'Frau': 0.10540860639557836,
                                                         'Förderung': 0.01329122252928017,
                                                         'Hilfeplan': 0.0001315962626661403,
                                                         'Hilfeplangespräch': 0.03961047506250823,
                                                         'Hilfestand': 0.0001315962626661403,
                                                         'Hilfeverlauf': 0.0001315962626661403,
                                                         'Jobcenter': 0.0001315962626661403,
                                                         'Jugendamt': 0.0001315962626661403,
                                                         'KG': 0.01329122252928017,
                                                         'KM': 0.03961047506250823,
                                                         'KV': 0.0001315962626661403,
                                                         'Kind': 0.03961047506250823,
                                                         'Kinder': 0.0001315962626661403,
                                                         'Kinderbetreuung': 0.0001315962626661403,
                                                         'Kirmes': 0.01329122252928017,
                                                         'Kita': 0.0001315962626661403,
                                                         'Kitaadressen': 0.0001315962626661403,
                                                         'Kitawechsel': 0.01329122252928017,
                                                         'LZT': 0.0001315962626661403,
                                                         'Lebensunterhalt': 0.0001315962626661403,
                                                         'Mandy': 0.0001315962626661403,
                                                         'Mittagsverpflegung': 0.0001315962626661403,
                                                         'Möglichkeiten': 0.01329122252928017,
                                                         'Perspektiven': 0.0001315962626661403,
                                                         'Perspektivenberatung': 0.01329122252928017,
                                                         'Placzek': 0.026450848795894197,
                                                         'Postbearbeitung': 0.01329122252928017,
                                                         'Psychologe': 0.0001315962626661403,
                                                         'Reflexion': 0.026450848795894197,
                                                         'Reflexionsgespräch': 0.0001315962626661403,
                                                         'Riebschläger': 0.01329122252928017,
                                                         'Rückführungsoptionen': 0.0001315962626661403,
                                                         'Rücksprache': 0.0001315962626661403,
                                                         'SBB': 0.03961047506250823,
                                                         'SMSKontakt': 0.01329122252928017,
                                                         'Saba': 0.0001315962626661403,
                                                         'Schwester': 0.0001315962626661403,
                                                         'SensibilisierungBeratung': 0.0001315962626661403,
                                                         'Sicherung': 0.0001315962626661403,
                                                         'Stand': 0.0001315962626661403,
                                                         'Stimmungsbild': 0.0001315962626661403,
                                                         'Telefonat': 0.13172785892880642,
                                                         'Telefonate': 0.0001315962626661403,
                                                         'Termin': 0.01329122252928017,
                                                         'Terminreflexion': 0.026450848795894197,
                                                         'Terminrücksprache': 0.0001315962626661403,
                                                         'Therapie': 0.0001315962626661403,
                                                         'Therapieeinrichtung': 0.0001315962626661403,
                                                         'Therapievorbereitung': 0.01329122252928017,
                                                         'UV': 0.03961047506250823,
                                                         'Ummeldung': 0.0001315962626661403,
                                                         'Umwidmung': 0.0001315962626661403,
                                                         'Unterlagen': 0.0001315962626661403,
                                                         'Urlaub': 0.0001315962626661403,
                                                         'Vorbereitung': 0.0001315962626661403,
                                                         'Wechselantrag': 0.0001315962626661403,
                                                         'Wochenreflexion': 0.0001315962626661403,
                                                         'aktuellem': 0.01329122252928017,
                                                         'aktueller': 0.0001315962626661403,
                                                         'altergerechte': 0.0001315962626661403,
                                                         'an': 0.0001315962626661403,
                                                         'anschließendes': 0.01329122252928017,
                                                         'bzgl': 0.0001315962626661403,
                                                         'der': 0.0001315962626661403,
                                                         'etc': 0.0001315962626661403,
                                                         'für': 0.0001315962626661403,
                                                         'fürzu': 0.01329122252928017,
                                                         'mit': 0.0001315962626661403,
                                                         'suchtspezifischen': 0.026450848795894197,
                                                         'und': 0.0001315962626661403,
                                                         'von': 0.026450848795894197,
                                                         'wegen': 0.0001315962626661403,
                                                         'zu': 0.0001315962626661403,
                                                         'zum': 0.05277010132912226,
                                                         'zur': 0.0001315962626661403,
                                                         'Ärzte': 0.0001315962626661403}}},
            'vocabulary': ['Mandy',
                           'Urlaub',
                           'Dokumentation',
                           'Email',
                           'an',
                           'Frau',
                           'Kirmes',
                           'zu',
                           'Antrag',
                           'Mittagsverpflegung',
                           'Sicherung',
                           'Lebensunterhalt',
                           'SMSKontakt',
                           'bzgl',
                           'Unterlagen',
                           'Bildungspaket',
                           'Terminrücksprache',
                           'Stimmungsbild',
                           'Fallspezifische',
                           'Beratung',
                           'zum',
                           'Hilfeverlauf',
                           'Büro',
                           'Wochenreflexion',
                           'Postbearbeitung',
                           'suchtspezifischen',
                           'Angebot',
                           'Telefonat',
                           'Flohrer',
                           'Therapieeinrichtung',
                           'Vorbereitung',
                           'FragebogenSuchtanamnese',
                           'SBB',
                           'wegen',
                           'Therapie',
                           'und',
                           'Möglichkeiten',
                           'der',
                           'Begleitung',
                           'mit',
                           'Placzek',
                           'UV',
                           'KM',
                           'Termin',
                           'Jugendamt',
                           'aktueller',
                           'Stand',
                           'Therapievorbereitung',
                           'Riebschläger',
                           'Perspektiven',
                           'LZT',
                           'Rückführungsoptionen',
                           'Telefonate',
                           'Kita',
                           'Rücksprache',
                           'Abholung',
                           'Kind',
                           'Hilfestand',
                           'Perspektivenberatung',
                           'Kinderbetreuung',
                           'Hilfeplangespräch',
                           'anschließendes',
                           'Reflexionsgespräch',
                           'Saba',
                           'Fallabsprache',
                           'CGrosche',
                           'aktuellem',
                           'KV',
                           'Hilfeplan',
                           'Reflexion',
                           'Schwester',
                           'Aufgaben',
                           'Wechselantrag',
                           'Absprachen',
                           'Kitaadressen',
                           'von',
                           'Anträgen',
                           'für',
                           'Jobcenter',
                           'KG',
                           'Drogenscreening',
                           'Aktenpflege',
                           'SensibilisierungBeratung',
                           'fürzu',
                           'Entwicklungsbedürfnissen',
                           'altergerechte',
                           'Förderung',
                           'Kinder',
                           'zur',
                           'Drogenlangzeittherapie',
                           'Terminreflexion',
                           'Ärzte',
                           'Psychologe',
                           'etc',
                           'Ummeldung',
                           'Emelly',
                           'Beibringen',
                           'Kitawechsel',
                           'Umwidmung']}


@api_view()
def distinct_project_ids(request):
    project_ids = Hours.objects.order_by('project_id').values_list('project_id', flat=True).distinct()
    return Response({"project_ids": project_ids})


def group_for_timespan(hours, timespan, start, end):
    time_ranges = []
    start = datetime.strptime(start, '%Y-%m-%d')
    end = datetime.strptime(end, '%Y-%m-%d')
    temp_start = start
    time_add = timedelta(days=timespan)
    count = 1

    # add all the time ranges that fit into the whole range and break before the last one
    while temp_start + time_add <= end:
        time_ranges.append({'start': temp_start, 'stop': temp_start + time_add})
        temp_start += time_add

    # add the last one which will typically not be complete
    time_ranges.append({'start': temp_start, 'stop': end})

    # got the time ranges, can now filter the hours for these time ranges and add the text to the time_ranges to extend the dicts
    for ti in time_ranges:
        temp_hours = hours.filter(start__gte=ti['start'], stop__lte=ti['stop'])
        text = ''
        for hour in temp_hours:
            text += str(hour.comment)
            text += ' '
        ti['comment'] = text
        ti['id'] = count
        count += 1

    #pprint(time_ranges)

    return time_ranges

@api_view(['POST'])
def start_analysis(request):

    project_id = request.data.get('chosenCaseId', None)
    start_date = request.data.get('start', None)
    end_date = request.data.get('end', None)
    config = request.data.get('config', {})
    timespan = int(config.get('timespan', 0))

    if timespan is 0:
        hours = Hours.objects.filter(project_id=project_id, start__gte=start_date, stop__lte=end_date)\
            .values('comment', 'id', 'start', 'stop')
    else:
        hours = group_for_timespan(
            Hours.objects.filter(project_id=project_id, start__gte=start_date, stop__lte=end_date), timespan,
            start_date, end_date)

    result = analyze(hours,
                         dirichlet_alpha=float(config['dirichletAlpha']),
                         dirichlet_eta=float(config['dirichletEta']),
                         n_topics=int(config['numberOfTopics']),
                         n_iter=int(config['numberOfIterations']),
                         random_state=int(config['randomSeed']),
                         n_top_words=int(config['displayedTopicsTopWords']),
                         n_top_topics=int(config['numberOfDisplayedTopTopics']),
                         filter_high_word_occ=float(config['removeHighFrequentWords']),
                         filter_no_word_entries=True,
                         ignore_capitalization=config['ignoreCapitalization'],
                         stemmer_language='german' if config['stemming'] else '',
                         stopword_language='german' if config['removeStopwords'] else '',
                         word_min_length=int(config['minimalWordLength']),
                         filter_numbers=config['removeNumbers'],
                         positive_text='')

    return Response(
        #{'hours': hours, 'lda_result': mock_lda, 'dictionary_result': mock_dict})
        {'hours': hours, 'lda_result': result['lda_result'], 'dictionary_result': result['dictionary_result']})


class HoursView(viewsets.ModelViewSet):
    serializer_class = HoursSerializer
    queryset = Hours.objects.all()
